<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="jij.marimoss.mypage.mapper.MyPageMapper">
  	
  	<!-- 전체 게시글 숫자 세기 -->
	<select id="selectMyBoardCount">
		SELECT COUNT(*)
		FROM "BOARD"
		WHERE BOARD_DEL_FL = 'N'
		AND MEMBER_NO = #{memberNo}
	</select>
  	
  	<!-- 조건 상위 12개 가져오기 -->
  	<select id="selectMyBoardList">
		SELECT 
		  B.BOARD_NO,
		  BOARD_TITLE,
		  BOARD_IMG_PATH,
		  BOARD_IMG_ORIGIN,
		  BOARD_IMG_RENAME,
		  (SELECT COUNT(*)
		   FROM "LIKE"
		   WHERE BOARD_NO = B.BOARD_NO
		   AND MEMBER_NO = #{memberNo}) AS "LIKE_FL",
		  COUNT(L.MEMBER_NO) AS LIKE_COUNT
		FROM "BOARD" B
		LEFT JOIN "LIKE" L ON (B.BOARD_NO = L.BOARD_NO)
		WHERE BOARD_DEL_FL = 'N'
		AND B.MEMBER_NO = #{memberNo}
		GROUP BY B.BOARD_NO, BOARD_TITLE, BOARD_IMG_PATH,
		  		   BOARD_IMG_ORIGIN, BOARD_IMG_RENAME
		ORDER BY BOARD_NO DESC
  	</select>
  	
  	
  	<!-- 테마 수정 -->
  	<update id="themeUpdate">
  		UPDATE "MEMBER"
  		SET 
  			MEMBER_THEME = #{themeUrl}
  		WHERE
  			MEMBER_NO = #{memberNo}
  	</update>
  	
  	
  	<!-- 프로필 수정 -->
  	<update id="profileImgUpdate">
  		UPDATE "MEMBER"
  		SET 
  			MEMBER_PROFILE = #{profileUrl}
  		WHERE
  			MEMBER_NO = #{memberNo}
  	</update>
  	
  	
</mapper>
